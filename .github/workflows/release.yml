# GitHub Actionså·¥ä½œæµï¼šè‡ªåŠ¨åˆ›å»ºReleaseç‰ˆæœ¬
# å½“æ¨é€tagæ—¶è‡ªåŠ¨æ„å»ºexeå¹¶åˆ›å»ºGitHub Release

# å·¥ä½œæµåç§°
name: Create Release

# è§¦å‘æ¡ä»¶ï¼šä»…å½“æ¨é€ä»¥'v'å¼€å¤´çš„tagæ—¶è§¦å‘
# ä¾‹å¦‚ï¼šv1.0.0, v2.1.0, v1.0.0-beta ç­‰
on:
  push:
    tags:
      - 'v*'  # åŒ¹é…æ‰€æœ‰ä»¥vå¼€å¤´çš„tag

# æƒé™è®¾ç½®ï¼šå…è®¸å†™å…¥ä»“åº“å†…å®¹ï¼ˆåˆ›å»ºReleaseéœ€è¦ï¼‰
permissions:
  contents: write

# å®šä¹‰å·¥ä½œæµä¸­çš„ä»»åŠ¡
jobs:
  # æ„å»ºå’Œå‘å¸ƒä»»åŠ¡
  build:
    # æŒ‡å®šè¿è¡Œç¯å¢ƒä¸ºæœ€æ–°ç‰ˆWindows
    runs-on: windows-latest
    
    # å®šä¹‰æ„å»ºæ­¥éª¤
    steps:
    # æ­¥éª¤1ï¼šæ£€å‡ºä»£ç åˆ°è¿è¡Œç¯å¢ƒ
    - name: Checkout code
      uses: actions/checkout@v4
    
    # æ­¥éª¤2ï¼šä½¿ç”¨PyInstalleråˆ›å»ºå¯æ‰§è¡Œæ–‡ä»¶
    - name: Create Executable
      id: create_executable  # ç»™è¿™ä¸ªæ­¥éª¤è®¾ç½®IDï¼Œæ–¹ä¾¿åç»­å¼•ç”¨
      uses: sayyid5416/pyinstaller@v1
      with:
        # æŒ‡å®šPythonç‰ˆæœ¬ä¸º3.12
        python_ver: '3.12'
        # æŒ‡å®šè¦æ‰“åŒ…çš„Pythonæ–‡ä»¶
        spec: 'main.py'
        # è®¾ç½®ç”Ÿæˆçš„exeæ–‡ä»¶å
        upload_exe_with_name: 'shrimp_package'
        # PyInstalleré€‰é¡¹ï¼šç”Ÿæˆå•ä¸ªexeæ–‡ä»¶
        options: "--onefile"
    
    # æ­¥éª¤3ï¼šåˆ›å»ºGitHub Releaseå¹¶ä¸Šä¼ æ„å»ºäº§ç‰©
    - name: Create GitHub Release
      uses: softprops/action-gh-release@v2
      # æ¡ä»¶ï¼šä»…å½“æ¨é€çš„æ˜¯tagæ—¶æ‰§è¡Œ
      if: startsWith(github.ref, 'refs/tags/')
      with:
        # ä¸Šä¼ distç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶åˆ°Release
        files: |
          dist/*
        # Releaseæ ‡é¢˜ï¼ˆå¯é€‰ï¼Œä½¿ç”¨tagåç§°ï¼‰
        name: Release ${{ github.ref_name }}
        # Releaseè¯´æ˜ï¼ˆå¯é€‰ï¼‰
        body: |
          ## ğŸ‰ æ–°ç‰ˆæœ¬å‘å¸ƒ
          
          ### ğŸ“¦ åŒ…å«æ–‡ä»¶
          - shrimp_package.exe - ä¸»ç¨‹åºå¯æ‰§è¡Œæ–‡ä»¶
          
          ### ğŸš€ ä½¿ç”¨æ–¹æ³•
          1. ä¸‹è½½ `shrimp_package.exe`
          2. åŒå‡»è¿è¡Œå³å¯
          
          ---
          è‡ªåŠ¨æ„å»ºäº: ${{ github.sha }}